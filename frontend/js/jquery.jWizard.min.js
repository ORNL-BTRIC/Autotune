/*! jWizard v1.6.2 ... Built: 2013-02-02 */
(function(e){e.widget("db.jWizard",{_stepIndex:0,_stepCount:0,_actualCount:0,_create:function(){this._buildSteps(),this._buildTitle(),this.options.menuEnable&&this._buildMenu(),this._buildButtons(),this.options.counter.enable&&this._buildCounter(),this.element.addClass("ui-widget jw-widget"),this._hoverable(this.element.find(".ui-state-default")),this._changeStep(this._stepIndex,!0)},destroy:function(){this._destroySteps(),this._destroyTitle(),this.options.menuEnable&&this._destroyMenu(),this._destroyButtons(),this.options.counter.enable&&this._destroyCounter(),this.element.removeClass("ui-widget jw-widget"),this._super()},disable:function(){this.element.addClass("ui-state-disabled").find("button").attr("disabled","disabled")},enable:function(){this.element.removeClass("ui-state-disabled").find("button").removeAttr("disabled")},option:function(e,t){if(this._superApply(arguments),"string"==typeof e&&t!==void 0){var n=e.split(".");switch(n[0]){case"buttons":switch(n[1]){case"jqueryui":if("enable"===n[2]){t?this.find(".jw-buttons > button").button("destroy"):(this._destroyButtons(),this._buildButtons());break}break;case"cancelHide":this.element.find(".jw-button-cancel").toggleClass("ui-helper-hidden",!!t);break;case"cancelType":this.element.find(".jw-button-cancel").attr("type",t);break;case"finishType":this.element.find(".jw-button-finish").attr("type",t);break;case"cancelText":this.element.find(".jw-button-cancel").text(t);break;case"previousText":this.element.find(".jw-button-previous").text(t);break;case"nextText":this.element.find(".jw-button-next").text(t);break;case"finishText":this.element.find(".jw-button-finish").text(t)}break;case"counter":switch(n[1]){case"enable":value?(this._buildCounter(),this._updateCounter()):this._destroyCounter();break;case"type":case"progressbar":case"location":this.options.counter.enable&&(this._destroyCounter(),this._buildCounter(),this._updateCounter());break;case"startCount":case"startHide":case"finishCount":case"finishHide":case"appendText":case"orientText":this.options.counter.enable&&this._updateCounter()}}}},_setOption:function(e,t){switch(this._superApply(arguments),e){case"titleHide":this.element.find(".jw-header").toggleClass("ui-helper-hidden",!t);break;case"menuEnable":t?(this._buildMenu(),this._updateMenu()):this._destroyMenu();break;case"counter":this._destroyCounter(),this._buildCounter(),this._updateCounter()}},firstStep:function(){this.changeStep(0,"first")},lastStep:function(){this.changeStep(this._stepCount-1,"last")},nextStep:function(){var e={wizard:this.element,currentStepIndex:this._stepIndex,nextStepIndex:this._stepIndex+1,delta:1};this._trigger("next",null,e)!==!1&&this.changeStep(this._stepIndex+1,"next")},previousStep:function(){var e={wizard:this.element,currentStepIndex:this._stepIndex,nextStepIndex:this._stepIndex-1,delta:-1};this._trigger("previous",null,e)!==!1&&this.changeStep(this._stepIndex-1,"previous")},changeStep:function(t,n){n=n||"manual",t="number"==typeof t?t:e(t).index();var i={wizard:this.element,currentStepIndex:this._stepIndex,nextStepIndex:t,delta:t-this._stepIndex,type:n};this._trigger("changestep",null,i)!==!1&&this._changeStep(t)},_effect:function(t,n,i,s,o){var a=this.options.effects[n][i];return s=s||"effect",t.length&&t.hasClass("jw-animated")?(a.callback=o||e.noop,t[s](a.type,a.options,a.duration,a.callback),void 0):(t[s](),o&&o.call(this),!1)},_updateNavigation:function(e){this._updateButtons(),this.options.menuEnable&&this._updateMenu(e),this.options.counter.enable&&this._updateCounter(e)},_buildTitle:function(){this.element.prepend(e("<div />",{"class":"jw-header ui-widget-header ui-corner-top"+(this.options.titleHide?" ui-helper-hidden":""),html:'<h2 class="jw-title'+(this.options.effects.enable||this.options.effects.title.enable?" jw-animated":"")+'" />'}))},_updateTitle:function(e){var t=this,n=this.element.find(".jw-title"),i=this.element.find(".jw-step:eq("+this._stepIndex+")");e?n.text(i.attr("title")):this._effect(n,"title","hide","hide",function(){n.text(i.attr("title")),t._effect(n,"title","show","show")})},_destroyTitle:function(){this.element.children(".jw-header").remove()},_buildSteps:function(){var t=this.element.children("div, fieldset");this._stepCount=t.length,t.addClass("jw-step").each(function(){var t=e(this);"fieldset"===this.tagName.toLowerCase()&&t.attr("title",t.find("legend").text())}),(this.options.effects.enable||this.options.effects.step.enable)&&t.addClass("jw-animated"),t.hide().wrapAll(e("<div />",{"class":"jw-content ui-widget-content ui-helper-clearfix",html:'<div class="jw-steps-wrap" />'})).eq(this._stepIndex).show()},_destroySteps:function(){this.element.find(".jw-step").show().unwrap().unwrap().unbind("show hide").removeClass("jw-step")},_changeStep:function(e,t){var n=this,i=this.element.find(".jw-step"),s=i.eq(this._stepIndex);if("number"==typeof e){if(0>e||e>i.length-1)return alert("Index "+e+" Out of Range"),!1;e=i.eq(e)}else if("object"==typeof e&&!e.is(i.selector))return alert("Supplied Element is NOT one of the Wizard Steps"),!1;t?(this._stepIndex=i.index(e),this._updateTitle(t),this._updateNavigation(t)):(this._disableButtons(),this._stepIndex=i.index(e),this._updateTitle(t),this._effect(s,"step","hide","hide",function(){n._effect(e,"step","show","show",function(){n._enableButtons(),n._updateNavigation(t)})}))},_buildMenu:function(){var t,n=[];this.element.addClass("jw-hasmenu"),this.element.find(".jw-step").each(function(t){n.push(e("<li />",{"class":"ui-corner-all "+(0===t?"jw-current ui-state-highlight":"jw-inactive ui-state-disabled"),html:e("<a />",{step:t,text:e(this).attr("title")})})[0])}),t=e("<div />",{"class":"jw-menu-wrap",html:e("<div />",{"class":"jw-menu",html:e("<ol />",{html:e(n)})})}),this.element.find(".jw-content").prepend(t),(this.options.effects.enable||this.options.effects.menu.enable)&&t.find("li").addClass("jw-animated"),t.find("a").click(e.proxy(function(t){var n=e(t.target),i=parseInt(n.attr("step"),10);n.parent().hasClass("jw-active")&&this.changeStep(i,this._stepIndex>=i?"previous":"next")},this))},_destroyMenu:function(){this.element.removeClass("jw-hasmenu").find(".jw-menu-wrap").remove()},_updateMenu:function(t){var n=this._stepIndex,i=this.element.find(".jw-menu");t||this._effect(i.find("li:eq("+n+")"),"menu","change"),i.find("a").each(function(){var t=e(this),i=t.parent(),s=parseInt(t.attr("step"),10),o="";n>s?o+="jw-active ui-state-default":s===n?o+="jw-current ui-state-highlight":s>n&&(o+="jw-inactive ui-state-disabled",t.removeAttr("href")),i.removeClass("jw-active jw-current jw-inactive ui-state-default ui-state-highlight ui-state-disabled").addClass(o)})},_buildCounter:function(){var t=e("<span />",{"class":"jw-counter ui-widget-content ui-corner-all jw-"+this.options.counter.orientText});"header"===this.options.counter.location?this.element.find(".jw-header").prepend(t):"footer"===this.options.counter.location&&this.element.find(".jw-footer").prepend(t),this.options.counter.startCount||this._stepCount--,this.options.counter.finishCount||this._stepCount--,(this.options.effects.enable||this.options.effects.counter.enable)&&t.addClass("jw-animated"),this.options.counter.progressbar&&t.html('<span class="jw-counter-text" /> <span class="jw-counter-progressbar" />').find(".jw-counter-progressbar").progressbar()},_updateCounter:function(e){var t=this.element.find(".jw-counter"),n=this.options.counter,i="",s=this._stepIndex,o=this._stepCount,a=0;n.startCount||(s--,o--),e||this._effect(t,"counter","change"),a=Math.round(100*(s/o)),"percentage"===n.type?i=(100>=a?a:100)+"%":"count"===n.type?(i=0>s?0:s>o?o:s,i+=" of "+o):i="N/A",n.appendText&&(i+=" "+n.appendText),n.progressbar?(this.element.find(".jw-counter-progressbar").progressbar("option","value",a),this.element.find(".jw-counter-text").text(i)):t.text(i),n.startHide&&0===this._stepIndex||n.finishHide&&this._stepIndex===this._actualCount-1?t.hide():t.show()},_destroyCounter:function(){this.element.find(".jw-counter").remove()},_buildButtons:function(){var t=this,n=this.options.buttons,i=e("<div />",{"class":"jw-footer ui-widget-header ui-corner-bottom"}),s=e('<button type="'+n.cancelType+'" class="ui-state-default ui-corner-all jw-button-cancel ui-priority-secondary'+(n.cancelHide?" ui-helper-hidden":"")+'">'+n.cancelText+"</button>"),o=e('<button type="button" class="ui-state-default ui-corner-all jw-button-previous">'+n.previousText+"</button>"),a=e('<button type="button" class="ui-state-default ui-corner-all jw-button-next">'+n.nextText+"</button>"),u=e('<button type="'+n.finishType+'" class="ui-state-default ui-corner-all jw-button-finish ui-state-highlight">'+n.finishText+"</button>");s.click(function(e){t._trigger("cancel",e)}),o.click(function(){t.previousStep()}),a.click(function(){t.nextStep()}),u.click(function(e){t._trigger("finish",e)}),n.jqueryui.enable&&(s.button({icons:{primary:n.jqueryui.cancelIcon}}),o.button({icons:{primary:n.jqueryui.previousIcon}}),a.button({icons:{secondary:n.jqueryui.nextIcon}}),u.button({icons:{secondary:n.jqueryui.finishIcon}})),this.element.append(i.append(e('<div class="jw-buttons" />').append(s).append(o).append(a).append(u)))},_updateButtons:function(){var e=this.element.find(".jw-step"),t=this.element.find(".jw-button-previous"),n=this.element.find(".jw-button-next"),i=this.element.find(".jw-button-finish");switch(e.index(e.filter(":visible"))){case-1:case 0:t.hide(),n.show(),i.hide();break;case e.length-1:t.show(),n.hide(),i.show();break;default:t.show(),n.show(),i.hide()}},_disableButtons:function(){this.element.find(".jw-buttons button").addClass("ui-state-disabled").attr("disabled",!0)},_enableButtons:function(){this.element.find(".jw-buttons button").removeClass("ui-state-disabled").attr("disabled",!1)},_destroyButtons:function(){this.element.find(".jw-footer").remove()},options:{titleHide:!1,menuEnable:!1,buttons:{jqueryui:{enable:!1,cancelIcon:"ui-icon-circle-close",previousIcon:"ui-icon-circle-triangle-w",nextIcon:"ui-icon-circle-triangle-e",finishIcon:"ui-icon-circle-check"},cancelHide:!1,cancelType:"button",finishType:"button",cancelText:"Cancel",previousText:"Previous",nextText:"Next",finishText:"Finish"},counter:{enable:!1,type:"count",progressbar:!1,location:"footer",startCount:!0,startHide:!1,finishCount:!0,finishHide:!1,appendText:"Complete",orientText:"left"},effects:{enable:!1,step:{enable:!1,hide:{type:"slide",options:{direction:"left"},duration:"fast"},show:{type:"slide",options:{direction:"left"},duration:"fast"}},title:{enable:!1,hide:{type:"slide",duration:"fast"},show:{type:"slide",duration:"fast"}},menu:{enable:!1,change:{type:"highlight",duration:"fast"}},counter:{enable:!1,change:{type:"highlight",duration:"fast"}}},cancel:e.noop,previous:e.noop,next:e.noop,finish:e.noop,changestep:function(e,t){return e.isDefaultPrevented()&&e.nextStepIndex!==void 0?(t.wizard.jWizard("changeStep",e.nextStepIndex),!1):void 0}}})})(jQuery);